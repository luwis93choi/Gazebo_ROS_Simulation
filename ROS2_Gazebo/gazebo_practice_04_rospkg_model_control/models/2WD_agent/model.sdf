<!-- Reference : How to Simulate a Robot Using Gazebo and ROS 2 (https://automaticaddison.com/how-to-simulate-a-robot-using-gazebo-and-ros-2/#Launch_Your_Robot_and_Warehouse_Using_ROS_2) -->

<!--
    Gazebo ROS differential drive plugin

    Send topics commands:
        ros2 topic pub /demo/cmd_vel geometry/Twist '{linear: {x: 0.05}}' -1
        ros2 topic pub /demo/cmd_vel goemetry/Twist '{angular: {z: 0.01}}' -1

    Listen topics commands:
        ros2 topic echo /demo/odom

    Listen TF:
        ros2 run tf2_ros tf2_echo odom chassis
        ros2 run tf2_ros tf2_echo chassis right_wheel
        ros2 run tf2_ros tf2_echo chassis left_wheel
-->

<sdf version='1.5'>
    <world name='test'>
    <model name='2WD_agent'>
    
        <!-- Define the model as a moving object -->
        <static>true</static>

        <!-- Rectangular base of the robot -->
        <link name='chassis'>
        
            <!-- Position of the center will be: -->
            <!-- X = 0m | Y = 0m | Z = 0.1m -->

            <!-- Orientation of the center will be: -->
            <!-- Roll = 0 rad | Pitch = 0 rad | Yaw = 0 rad -->
            <pose>0 0 0.04 0 0 0</pose>

            <!-- [Base of 2WD Vehicle] -->
            <!-- Define the shape of collision area of base -->
            <collision name='collision'>
                <geometry>
                    <box>
                        <!-- Box-shaped collision area with 0.4m in lenght, 0.2m in width, and 0.1m in height -->
                        <size>0.4 0.2 0.1</size>
                    </box>
                </geometry>
            </collision>

            <!-- Define the visual representation of the base -->
            <visual name='visual'>
                <pose>0 0 0.02 0 0 0</pose>
                <geometry>
                    <box>
                        <!-- Define visual shape of the base as box with same collision area -->
                        <size>0.4 0.2 0.1</size>
                    </box>
                </geometry>
            </visual>

            <!-- [Front Caster Wheel] -->
            <!-- Define the shape of collision area of caster wheel -->
            <collision name='caster_collision'>
                <pose>-0.19 0 0 0 0 0</pose>
                <geometry>
                    <sphere>
                        <radius>0.06</radius>
                    </sphere>
                </geometry>

                <!-- Assign friction property to the wheel -->
                <surface>
                    <friction>
                        <ode>
                            <!-- Coefficients for friction -->
                            <mu>0</mu>
                            <mu2>0</mu2>
                            <!-- Force dependent slip -->
                            <slip1>1.0</slip1>
                            <slip2>1.0</slip2>
                        </ode>
                    </friction>
                </surface>
            </collision>

            <!-- Define visual shape of the caster wheel -->
            <visual name='caster_visual'>
                <pose>-0.19 0 0 0 0 0</pose>
                <geometry>
                    <sphere>
                        <radius>0.06</radius>
                    </sphere>
                </geometry>
            </visual>
        </link>

        <!-- [Left Wheel] -->
        <link name='left_wheel'>
            <pose>0.12 0.19 0.1 0 1.5707 1.5707</pose>
            
            <collision name='collision'>
                <geometry>
                    <cylinder>
                        <radius>0.12</radius>
                        <length>0.08</length>
                    </cylinder>
                </geometry>
            </collision>

            <visual name='visual'>
                <geometry>
                    <cylinder>
                        <radius>0.12</radius>
                        <length>0.08</length>
                    </cylinder>
                </geometry>
            </visual>
        </link>

        <!-- [Right Wheel] -->
        <link name='right wheel'>
            <pose>0.12 -0.19 0.1 0 1.5707 1.5707</pose>

            <collision name='collision'>
                <geometry>
                    <cylinder>
                        <radius>0.12</radius>
                        <length>0.08</length>
                    </cylinder>
                </geometry>
            </collision>

            <visual name='visual'>
                <geometry>
                    <cylinder>
                        <radius>0.12</radius>
                        <length>0.08</length>
                    </cylinder>
                </geometry>
            </visual>
        </link>

        <!-- [LiDAR Sensor] -->

    </model>
    </world>
</sdf>